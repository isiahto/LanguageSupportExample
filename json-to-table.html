<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Json to table</title>
    <!-- <meta name="description" content="The HTML5 Herald"> -->
    <!-- <meta name="author" content="SitePoint"> -->

    <script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <style type="text/css">
      * {
        font-family: 'Roboto', sans-serif;
      }


      .border {
        border-style: solid;
        border-width: 2px;
      }

      .svg-icon {
        width: 1em;
        height: 1em;
      }

      .svg-icon path,
      .svg-icon polygon,
      .svg-icon rect {
        fill: #808080;
      }

    </style>
  </head>

  <body>

    <div>
      <h2>Json to table</h2>
    </div>

    <hr/>
    <!-- Language switch -->
    <div>
      <select id="sel_lang">
        <option selected="">En</option>
        <option>Fr</option>
      </select>
    </div>

    <div class="border">
      <h4>input area</h4>
      Name: <input type="text" id="txt_name">
      DOB: <input type="text" id="txt_dob">
      Alive: <input type="checkbox" id="chk_alive">
      <button id="btn_add">Add</button>
    </div>

    <div class="border">
      <table>
        <thead>
          <th>r</th>
          <th>Name</th>
          <th>DOB</th>
          <th>Alive</th>
        </thead>
        <tbody id="tb">
          <tr id="tr-1">
            <td><a onclick='return del();'>X</a></td>
            <td>t</td>
            <td>t</td>
            <td>test</td>
          </tr>

        </tbody>
      </table>
      <input type="hidden" value="0" id="hid_rowid">
    </div>


    <div id='tout' style="height:500px;">
    </div>

    <script>
      function del() {
        document.getElementById('tr-1').remove(); // good.
        return false;
      }




      function addUserData(inputIds) {
        
        var tr = document.createElement('tr');
        var trid = "tr" + getRowId();
        tr.id = trid;

        // delete button
        tr.appendChild(createRemoveInput(trid));
        /*
        1. delete button
        2. Name
        3. DOB
        4. Alive
        var inputIds = ['txt_..', ...];
        */

        inputIds.forEach( function(element, index) {
          addTDtoTR(tr, element);
        });

        // addTDtoTR(tr, 'txt_name');
        // addTDtoTR(tr, 'txt_dob');
        // addTDtoTR(tr, 'chk_alive');

      
        document.getElementById('tb').appendChild(tr);
      }


      function addTDtoTR(tr, inputId) {
        if (!tr || !inputId) {
          console.error('[addTDtoTR] null input detected')
          return;
        }

        // get inputId type (LEFT(inputId, 3)); -> chk / txt

        var type = inputId.substring(0, 3);

        switch (type)
        {          
          case 'chk':
            var isChecked = document.getElementById(inputId).checked;
            tr.appendChild(createTdwithCheckbox(isChecked));
            return;
          case 'sel':
          case 'txt':
            var text = document.getElementById(inputId).value;
            tr.appendChild(createTdWithLabel(text));
            return;
          default:
            console.error('unexpected type:', type);
            tr.appendChild(createLabel());
            return;
        }
      }

      function createRemoveInput(trid) {
        // Remove Input: <a>
        var removeInput = document.createElement('a');
        removeInput.innerText = 'X';
        removeInput.onclick = createOnclickForRemoval(trid);
        return createTd(removeInput);
      }

      function createOnclickForRemoval(trid) {
        return function() {
          document.getElementById(trid).remove();
        }
      }

      function createTd(node) {
        var td = document.createElement('td');
        td.appendChild(node);
        return td;
      }

      // tested
      function createTdwithCheckbox(value) {
        var chk = document.createElement('input');
        chk.setAttribute('type', 'checkbox');
        chk.setAttribute('disabled', 'true');
        chk.checked = !!value;
        return createTd(chk);
      }

      // tested
      function createTdWithLabel(value) {
        var lab = document.createElement('label');
        lab.innerText = value ? value : '';
        return createTd(lab);
      }


      function getRowId() {
        var counter = document.getElementById('hid_rowid');
        var n = parseInt(counter.value);
        counter.value = n + 1;
        return n;
      }



      var inputArr = ['txt_name','txt_dob','chk_alive'];
      $('#btn_add').click(() => addUserData(inputArr));

    </script>
  </body>
</html>